# 6.1 함수 추출하기
추출하기는 결국 이름 짓기다. 코드 이해도가 높아지면 이름을 바꿔야할 때가 많다.

before
```javascript
function printOwing(invoice) {
    printBanner();
    let outstanding = calculateOutstanding();
    
    // 세부사항 출력
    console.log(`고객명: ${invoice.customer}`);
    console.log(`채무액: ${outstanding}`);
} 
```

after
```javascript
function printOwing(invoice) {
    printBanner();
    let outstanding = calculateOutstanding();
    printDetails(outstanding)
    
    function printDetails(outstanding) {
        console.log(`고객명: ${invoice.customer}`);
        console.log(`채무액: ${outstanding}`);
    }
} 
```

## 배경
>코드 조각을 찾아 무슨 일을 하는지 파악한 다음, 독립된 함수로 추출하고 목적에 맞는 이름을 붙인다.

### 언제 독립된 함수로 묶어야 하는가?
- 길이 기준
   - 화면에 넘어간다 ?
- 재사용성 기준
   - 두 번 이상 사용 ?

➡️➡️➡️ **목적과 구현을 분리**할 때
- 메서드 이름이 구현 코드보다 길 수도 있다.
- **짧은 함수의 이점은 이름을 잘 지어야만 발휘되므로 특별히 신경 써야 한다.**
- 코드 덩어리를 추출한 함수의 이름을 지을 때 주석을 참고하면 도움이 된다.

## 절차
1. 함수를 새로 만들고 목적을 잘 드러내는 이름을 붙인다. ('어떻게'가 아닌 **'무엇을'** 하는지가 드러나야 한다.)
> - 대상 코드가 함수 호출문 하나처럼 매우 간단하더라도 함수로 뽑아서 목적이 더 잘 드러나는 이름을 붙일 수 있다면 추출한다.
>   - 이런 이름이 떠오르지 않는다면 함수로 추출하면 안 된다.
>   - 하지만 추출하는 과정에서 좋은 이름이 떠오를 수 있으니 처음부터 최선의 이름부터 짓고 시작할 필요는 없다.
> - 일단 함수로 추출해서 사용해보고 효과가 크지 않으면 다시 원래 상태로 인라인해도 된다.
>   - 그 과정에서 깨달은 게 있다면 시간 낭비는 아니기 때문~
> - 중첩 함수를 지원하는 언어를 사용한다면 추출한 함수를 원래 함수 안에 중첩시킨다.
>   - 그러면 다음 단계에서 수행할, 유효범위를 벗어난 변수를 처리하는 작업을 줄일 수 있다.
> - 원래 함수의 바깥으로 꺼내야 할 때가 오면 언제든 함수 옮기기를 적용하면 된다.

2. 추출할 코드를 원본 함수에서 복사하여 새 함수에 붙여넣는다.
3. 추출한 코드 중 원본 함수의 지역변수를 참조하거나 추출한 함수의 유효범위를 벗어나는 변수는 없는지 검사한다.
   - 있다면 매개변수로 전달한다.
> - 원본 함수의 중첩 함수로 추출할 때는 이런 문제가 생기지 않는다.
> - 일반적으로 함수에는 지역 변수와 매개변수가 있기 마련인데, 가장 일반적인 처리방법은 **모두 인수로 전달하는 것**이다.
>   - 사용은 하지만 값이 바뀌지 않는 변수는 대체로 이렇게 쉽게 처리할 수 있다.
> - 추출한 코드에서만 사용하는 변수가 추출한 함수 밖에 선언되어 있다면 추출한 함수 안에서 선언하도록 수정한다.
> - 추출한 코드 안에서 값이 바뀌는 변수 중에서 값으로 전달되는 것들은 주의해서 처리한다.
>   - 이런 변수가 하나 뿐이라면 추출한 코드를 질의 함수로 취급해서 그 결과(반환값)를 해당 변수에 선언한다.
> - 때로는 추출한 코드에서 값을 수정하는 지역 변수가 많을 수 있다.
>   - 함수 추출을 멈추고, `변수 쪼개기`나 `임시 변수를 질의함수로 바꾸기`와 같은 리팩터링을 먼저 적용한다.
>   - 그 후 다시 함수 추출을 시도한다.

4. 변수를 다 처리했다면 컴파일한다.
5. 원본 함수에서 추출한 코드 부분을 새로 만든 함수를 호출하는 문장으로 바꾼다.(즉, 추출한 함수로 위임한다.)
6. 테스트한다.
7. 다른 코드에 방금 추출한 것과 똑같거나 비슷한 코드가 없는지 살핀다.
   - 있다면 방금 추출한 새 함수를 추출하도록 바꿀지 검토한다. (`인라인 코드를 함수 호출로 바꾸기`)
   - 리팩터링 도구로 도움 받아보자.

