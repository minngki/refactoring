# 3.7 뒤엉킨 변경

**코드를 수정할 때는 시스템에서 고쳐야 하 ㄹ딱 한 군데를 찾아서 그 부분만 수정할 수 있어야 한다.**
이렇게 하지 않으면 뒤엉킨 변경과 산탄총 수술 중 하나가 풍기기 마련이다.

단일 책임 원칙(SRP)이 제대로 지켜지지 않을 때 나타난다.
**하나의 모듈이 서로 다른 이유들로 인해 여러 가지 방식으로 변경**되는 일이 많을 때 발생한다.

ex) 안 좋은 예

- DB가 추가될 때 마다 함수 세 개를 바꿔야 한다 ? (X)
- 금융 상품이 추가될 때마다 또 다른 함수 네 개를 바꿔야 한다? (X)

➡️ 데이터베이스 연동과 금융 상품 처리는 서로 다른 맥락에서 이뤄지므로 독립된 모듈로 분리해야 한다. **그래야 무언가 수정할 때 해당 맥락의 코드만 이해해도 진행 가능**하다.

그러나 개발 초기에는 맥락 사이의 경계를 명확히 나누기가 어렵고, 소프트웨어 시스템의 기능이 변경되면서 이 경계도 끊임없이 움직이므로 어렵다.

## 1. 단계 쪼개기

- 데이터베이스에서 데이터를 가져와서 금융 상품 로직에서 처리해야 하는 일처럼 순차적으로 실행되는 게 자연스러운 맥락이라면,
- **다음 맥락에 필요한 데이터를 특정한 데이터 구조에 담아 전달하게 하는 식으로 단계를 분리한다.**

## 2. 함수 옮기기

- 전체 \*\*처리 과정 곳곳에서 각기 다른 맥락의 함수를 호출하는 빈도가 높다면,
- 각 맥락에 해당하는 적당한 모듈들을 만들어서\*\* 관련 함수들을 모은다. 그러면 처리 과정이 맥락 별로 구분된다.

  - 이 때, 옮기기 전에 **함수 추출하기**부터 수행한다.
  - 모듈이 클래스라면 **클래스 추출하기**
